---
layout: default
title: '11G OCM Troubleshoot fast materialized views to fast refresh and query rewrite'
base-url: home/11g-ocm/11g-ocm-data-and-data-warehouse-management/11g-ocm-troubleshoot-fast-materialized-views-to-fast-refresh-and-query-rewrite.html
breadcrumbs:
- title: 'Home'
  url: home.html
- title: '11G OCM'
  url: home/11g-ocm.html
- title: '11G OCM Data and Data Warehouse Management'
  url: home/11g-ocm/11g-ocm-data-and-data-warehouse-management.html
- title: '11G OCM Troubleshoot fast materialized views to fast refresh and query rewrite'
  url: home/11g-ocm/11g-ocm-data-and-data-warehouse-management/11g-ocm-troubleshoot-fast-materialized-views-to-fast-refresh-and-query-rewrite.html
table-of-contents:
- toc-url: References
  toc-text: References
- toc-url: Overview
  toc-text: Overview
- toc-url: Reading-Notes
  toc-text: Reading Notes
  toc-menu:
  - toc-url: Overview-of-the-SQL-Access-Advisor
    toc-text: Overview of the SQL Access Advisor
  - toc-url: Tuning-Materialized-Views-for-Fast-Refresh-and-Query-Rewrite
    toc-text: Tuning Materialized Views for Fast Refresh and Query Rewrite
  - toc-url: EXPLAIN_MVIEW
    toc-text: EXPLAIN_MVIEW
  - toc-url: EXPLAIN_REWRITE
    toc-text: EXPLAIN_REWRITE
- toc-url: Test-Case
  toc-text: Test Case
  toc-menu:
  - toc-url: Set-Up-Test-User
    toc-text: Set Up Test User
  - toc-url: Using-TUNE_MVIEW
    toc-text: Using TUNE_MVIEW
  - toc-url: Second-Attempt-with-TUNE_MVIEW
    toc-text: Second Attempt with TUNE_MVIEW
  - toc-url: Using-EXPLAIN_MVIEW
    toc-text: Using EXPLAIN_MVIEW
  - toc-url: Enable-Query-Rewrite
    toc-text: Enable Query Rewrite
---
<div dir="ltr">
 <br/>
 <h3>
  <a name="TOC-References">
  </a>
  References
 </h3>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/toc.htm" rel="nofollow">
   Oracle® Database Performance Tuning Guide 11g Release 1 (11.1)
  </a>
 </p>
 <ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#insertedID0" rel="nofollow">
    Chapter 18, "SQL Access Advisor"
   </a>
  </li>
  <ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#CHDEEBAI" rel="nofollow">
     Overview of the SQL Access Advisor
    </a>
   </li>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#i1018993" rel="nofollow">
     Tuning Materialized Views for Fast Refresh and Query Rewrite
    </a>
   </li>
   <ul>
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#autoId38" rel="nofollow">
      DBMS_ADVISOR.TUNE_MVIEW Procedure
     </a>
    </li>
    <ul>
     <li>
      <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#i1038234" rel="nofollow">
       TUNE_MVIEW Syntax and Operations
      </a>
     </li>
     <li>
      <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#i1038256" rel="nofollow">
       Accessing TUNE_MVIEW Output Results
      </a>
     </li>
    </ul>
   </ul>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/toc.htm" rel="nofollow">
   Oracle® Database PL/SQL Packages and Types Reference 11g Release 1 (11.1)
  </a>
 </p>
 <ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#insertedID0" rel="nofollow">
    Chapter 17, "DBMS_ADVISOR"
   </a>
  </li>
  <ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1010465" rel="nofollow">
     <span style="font-family:monospace">
      CREATE_FILE
     </span>
    </a>
   </li>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1012023" rel="nofollow">
     <span style="font-family:monospace">
      GET_TASK_SCRIPT
     </span>
    </a>
   </li>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
     <span style="font-family:monospace">
      TUNE_MVIEW
     </span>
    </a>
   </li>
  </ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#insertedID0" rel="nofollow">
    Chapter 79, "DBMS_MVIEW"
   </a>
  </li>
  <ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#CEGGEHHC" rel="nofollow">
     <span style="font-family:monospace">
      EXPLAIN_MVIEW
     </span>
    </a>
   </li>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#i997015" rel="nofollow">
     <span style="font-family:monospace">
      EXPLAIN_REWRITE
     </span>
    </a>
   </li>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/toc.htm" rel="nofollow">
   Oracle® Database Reference 11g Release 1 (11.1)
  </a>
 </p>
 <ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/initparams_part.htm#i200948" rel="nofollow">
    Part I Initialization Parameters
   </a>
  </li>
  <ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/initparams189.htm#CHDDEIID" rel="nofollow">
     <span style="font-family:monospace">
      QUERY_REWRITE_ENABLED
     </span>
    </a>
   </li>
  </ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_part.htm#i125539" rel="nofollow">
    Part II Static Data Dictionary Views
   </a>
  </li>
  <ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_5065.htm#i1628398" rel="nofollow">
     <span style="font-family:monospace">
      DBA_TUNE_MVIEW
     </span>
    </a>
   </li>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/toc.htm" rel="nofollow">
   Oracle® Database SQL Language Reference 11g Release 1 (11.1)
  </a>
 </p>
 <ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6002.htm#i2063793" rel="nofollow">
    <span style="font-family:monospace">
     CREATE MATERIALIZED VIEW
    </span>
   </a>
  </li>
 </ul>
 <h3>
  <a name="TOC-Overview">
  </a>
  Overview
 </h3>
 <p>
  The objective from the
  <a href="http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=41&amp;p_exam_id=11gOCMU#3" rel="nofollow">
   11G OCM Upgrade Exam
  </a>
  is:
 </p>
 <blockquote>
  Troubleshoot fast materialized views to fast refresh and query rewrite
 </blockquote>
 <h3>
  <a name="TOC-Reading-Notes">
  </a>
  Reading Notes
 </h3>
 <h4>
  <a name="TOC-Overview-of-the-SQL-Access-Advisor">
  </a>
  Overview of the SQL Access Advisor
 </h4>
 <p>
  “
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#CHDEEBAI" rel="nofollow">
   Overview of the SQL Access Advisor
  </a>
  ” says that:
 </p>
 <blockquote>
  <p>
   The SQL Access Advisor, using the
   <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
    <span style="font-family:monospace">
     TUNE_MVIEW
    </span>
   </a>
   procedure, also recommends how to optimize materialized views so that they can be fast refreshable and take advantage of general query rewrite.
  </p>
 </blockquote>
 <h4>
  <a name="TOC-Tuning-Materialized-Views-for-Fast-Refresh-and-Query-Rewrite">
  </a>
  Tuning Materialized Views for Fast Refresh and Query Rewrite
 </h4>
 <p>
  “
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28274/advisor.htm#i1018993" rel="nofollow">
   Tuning Materialized Views for Fast Refresh and Query Rewrite
  </a>
  ” says that:
 </p>
 <blockquote>
  <p>
   To further facilitate the use of materialized views, the
   <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
    <span style="font-family:monospace">
     TUNE_MVIEW
    </span>
   </a>
   procedure shows you how to optimize your
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6002.htm#i2063793" rel="nofollow">
    <span style="font-family:monospace">
     CREATE MATERIALIZED VIEW
    </span>
   </a>
   statement and to meet other requirements such as materialized view log and rewrite equivalence relationship for fast refresh and general query rewrite.
   <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
    <span style="font-family:monospace">
     TUNE_MVIEW
    </span>
   </a>
   analyzes and processes the
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6002.htm#i2063793" rel="nofollow">
    <span style="font-family:monospace">
     CREATE MATERIALIZED VIEW
    </span>
   </a>
   statement and generates two sets of output results: one for the materialized view implementation and the other for undoing the
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6002.htm#i2063793" rel="nofollow">
    <span style="font-family:monospace">
     CREATE MATERIALIZED VIEW
    </span>
   </a>
   operations. The two sets of output results can be accessed through views or be stored in external script files created by the SQL Access Advisor. These external script files are ready to execute to implement the materialized view.
  </p>
 </blockquote>
 <h4>
  <a name="TOC-EXPLAIN_MVIEW">
  </a>
  EXPLAIN_MVIEW
 </h4>
 <p>
  “
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#CEGGEHHC" rel="nofollow">
   <span style="font-family:monospace">
    EXPLAIN_MVIEW
   </span>
  </a>
  ” says that:
 </p>
 <blockquote>
  <p>
   This procedure enables you to learn what is possible with a materialized view or potential materialized view. For example, you can determine if a materialized view is fast refreshable and what types of query rewrite you can perform with a particular materialized view.
  </p>
 </blockquote>
 <h4>
  <a name="TOC-EXPLAIN_REWRITE">
  </a>
  EXPLAIN_REWRITE
 </h4>
 <p>
  “
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#i997015" rel="nofollow">
   <span style="font-family:monospace">
    EXPLAIN_REWRITE
   </span>
  </a>
  ” says that:
 </p>
 <blockquote>
  <p>
   This procedure enables you to learn why a query failed to rewrite, or, if it rewrites, which materialized views will be used. Using the results from the procedure, you can take the appropriate action needed to make a query rewrite if at all possible.
  </p>
 </blockquote>
 <h3>
  <a name="TOC-Test-Case">
  </a>
  Test Case
 </h3>
 <h4>
  <a name="TOC-Set-Up-Test-User">
  </a>
  Set Up Test User
 </h4>
 <p>
  The
  <span style="font-family:monospace">
   SH
  </span>
  user is set up for the test as follows:
 </p>
 <blockquote style="font-family:monospace">
  ALTER USER sh ACCOUNT UNLOCK;
  <br/>
  GRANT ADVISOR, CREATE MATERIALIZED VIEW TO sh;
  <br/>
 </blockquote>
 <h4>
  <a name="TOC-Using-TUNE_MVIEW">
  </a>
  Using TUNE_MVIEW
 </h4>
 <p>
  Using the test query from
  <a href="home/11g-ocm/11g-ocm-data-and-data-warehouse-management/11g-ocm-troubleshoot-fast-materialized-views-to-fast-refresh-and-query-rewrite.html">
   Use SQL Tuning Advisor
  </a>
  , I attempted to invoke the
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
   <span style="font-family:monospace">
    TUNE_MVIEW
   </span>
  </a>
  procedure as the
  <span style="font-family:monospace">
   SH
  </span>
  user:
 </p>
 <blockquote style="font-family:monospace">
  DECLARE
  <br/>
  sql_text VARCHAR2(4000);
  <br/>
  task_name VARCHAR2(32);
  <br/>
  BEGIN
  <br/>
  sql_text := '
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6002.htm#i2063793" rel="nofollow">
   CREATE MATERIALIZED VIEW
  </a>
  ocm11g AS -
  <br/>
  SELECT -
  <br/>
  products.prod_category, -
  <br/>
  products.prod_subcategory, -
  <br/>
  times.calendar_year, -
  <br/>
  SUM( sales.quantity_sold ) -
  <br/>
  AS total_quantity_sold, -
  <br/>
  SUM( sales.amount_sold ) -
  <br/>
  AS total_amount_sold -
  <br/>
  FROM -
  <br/>
  sales -
  <br/>
  INNER JOIN -
  <br/>
  products -
  <br/>
  USING( prod_id ) -
  <br/>
  INNER JOIN -
  <br/>
  customers -
  <br/>
  USING( cust_id ) -
  <br/>
  INNER JOIN -
  <br/>
  countries -
  <br/>
  USING( country_id ) -
  <br/>
  INNER JOIN -
  <br/>
  channels -
  <br/>
  USING( channel_id ) -
  <br/>
  INNER JOIN -
  <br/>
  times -
  <br/>
  USING( time_id ) -
  <br/>
  WHERE -
  <br/>
  products.prod_valid = ''A'' -
  <br/>
  AND -
  <br/>
  channels.channel_class = ''Direct'' -
  <br/>
  AND -
  <br/>
  customers.cust_valid = ''A'' -
  <br/>
  AND -
  <br/>
  countries.country_name = ''Australia'' -
  <br/>
  GROUP BY -
  <br/>
  products.prod_category, -
  <br/>
  products.prod_subcategory, -
  <br/>
  times.calendar_year -
  <br/>
  ORDER BY -
  <br/>
  products.prod_category, -
  <br/>
  products.prod_subcategory, -
  <br/>
  times.calendar_year';
  <br/>
  task_name := 'OCM11G';
  <br/>
  dbms_advisor.
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
   TUNE_MVIEW
  </a>
  ( task_name, sql_text );
  <br/>
  END;
  <br/>
  /
  <br/>
 </blockquote>
 <p>
  However, this fails with the following error messages:
 </p>
 <pre>ERROR at line 1:
ORA-13600: error encountered in Advisor
QSM-03112: Invalid CREATE MATERIALIZED VIEW statement
ORA-00928: missing SELECT keyword
ORA-06512: at "SYS.DBMS_SYS_ERROR", line 86
ORA-06512: at "SYS.PRVT_ACCESS_ADVISOR", line 205
ORA-06512: at "SYS.PRVT_TUNE_MVIEW", line 460
ORA-06512: at "SYS.PRVT_TUNE_MVIEW", line 901
ORA-06512: at "SYS.DBMS_ADVISOR", line 734
ORA-06512: at line 48
</pre>
 <p>
  When I execute the script for the materialized view by itself, the materialized view is created successfully.
 </p>
 <h4>
  <a name="TOC-Second-Attempt-with-TUNE_MVIEW">
  </a>
  Second Attempt with TUNE_MVIEW
 </h4>
 <p>
  I decided to use a simpler materialized view to test the
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_advis.htm#i1001342" rel="nofollow">
   <span style="font-family:monospace">
    TUNE_MVIEW
   </span>
  </a>
  procedure:
 </p>
 <blockquote style="font-family:monospace">
  variable task_name varchar2(32)
  <br/>
  variable sql_text varchar2(4000)
  <br/>
  exec :task_name := 'OCM11GPROD'
  <br/>
  exec :sql_text := 'CREATE MATERIALIZED VIEW ocm11g_prod AS  select prod_category, count(*) as num_products from products group by prod_category'
  <br/>
  exec dbms_advisor.tune_mview( :task_name, :sql_text )
  <br/>
 </blockquote>
 <p>
  This worked fine. The results from
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_5065.htm#i1628398" rel="nofollow">
   <span style="font-family:monospace">
    DBA_TUNE_MVIEW
   </span>
  </a>
  are:
 </p>
 <blockquote style="font-family:monospace">
  SELECT * FROM
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_5065.htm#i1628398" rel="nofollow">
   DBA_TUNE_MVIEW
  </a>
  WHERE task_name = 'OCM11GPROD';
 </blockquote>
 <table border="1" cellpadding="0" cellspacing="0">
  <thead>
   <tr>
    <th>
     OWNER
    </th>
    <th>
     TASK_NAME
    </th>
    <th>
     ACTION_ID
    </th>
    <th>
     SCRIPT_TYPE
    </th>
    <th>
     STATEMENT
    </th>
   </tr>
  </thead>
  <tbody>
   <tr>
    <td>
     SH
    </td>
    <td>
     OCM11GPROD
    </td>
    <td align="right">
     3
    </td>
    <td>
     IMPLEMENTATION
    </td>
    <td>
     CREATE MATERIALIZED VIEW LOG ON "SH"."PRODUCTS" WITH ROWID, SEQUENCE ("PROD_CATEGORY")  INCLUDING NEW VALUES
    </td>
   </tr>
   <tr>
    <td>
     SH
    </td>
    <td>
     OCM11GPROD
    </td>
    <td align="right">
     4
    </td>
    <td>
     IMPLEMENTATION
    </td>
    <td>
     ALTER MATERIALIZED VIEW LOG FORCE ON "SH"."PRODUCTS" ADD ROWID, SEQUENCE ("PROD_CATEGORY")  INCLUDING NEW VALUES
    </td>
   </tr>
   <tr>
    <td>
     SH
    </td>
    <td>
     OCM11GPROD
    </td>
    <td align="right">
     5
    </td>
    <td>
     IMPLEMENTATION
    </td>
    <td>
     CREATE MATERIALIZED VIEW SH.OCM11G_PROD   REFRESH FAST WITH ROWID DISABLE QUERY REWRITE AS SELECT SH.PRODUCTS.PROD_CATEGORY C1, COUNT(*) M1 FROM SH.PRODUCTS GROUP BY SH.PRODUCTS.PROD_CATEGORY
    </td>
   </tr>
   <tr>
    <td>
     SH
    </td>
    <td>
     OCM11GPROD
    </td>
    <td align="right">
     6
    </td>
    <td>
     UNDO
    </td>
    <td>
     DROP MATERIALIZED VIEW SH.OCM11G_PROD
    </td>
   </tr>
  </tbody>
 </table>
 <p>
  It appears that I can make the materialized view fast refreshable, but query rewrite is disabled.
 </p>
 <h4>
  <a name="TOC-Using-EXPLAIN_MVIEW">
  </a>
  Using EXPLAIN_MVIEW
 </h4>
 <p>
  First, the user,
  <span style="font-family:monospace">
   SH
  </span>
  , is granted the appropriate authorities:
 </p>
 <blockquote style="font-family:monospace">
  GRANT CREATE TABLE TO sh;
 </blockquote>
 <p>
  Then, the user,
  <span style="font-family:monospace">
   SH
  </span>
  , creates the
  <span style="font-family:monospace">
   MV_CAPABILITIES_TABLE
  </span>
  :
 </p>
 <blockquote style="font-family:monospace">
  @?/rdbms/admin/utlxmv
 </blockquote>
 <p>
  Next, the first materialized view created above,
  <span style="font-family:monospace">
   OCM11G
  </span>
  , is examined:
 </p>
 <blockquote style="font-family:monospace">
  EXEC DBMS_MVIEW.
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#CEGGEHHC" rel="nofollow">
   EXPLAIN_MVIEW
  </a>
  ( 'OCM11G', 'OCM11G' )
  <br/>
  COMMIT;
  <br/>
  SELECT CAPABILITY_NAME,
  <br/>
  POSSIBLE,
  <br/>
  RELATED_TEXT,
  <br/>
  MSGNO,
  <br/>
  MSGTXT
  <br/>
  FROM mv_capabilities_table
  <br/>
  WHERE statement_id = 'OCM11G';
  <br/>
 </blockquote>
 <p>
  The result is:
 </p>
 <table border="1" cellpadding="0" cellspacing="0">
  <thead>
   <tr>
    <th>
     CAPABILITY_NAME
    </th>
    <th>
     POSSIBLE
    </th>
    <th>
     RELATED_TEXT
    </th>
    <th>
     MSGNO
    </th>
    <th>
     MSGTXT
    </th>
   </tr>
  </thead>
  <tbody>
   <tr>
    <td>
     PCT
    </td>
    <td>
     Y
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_COMPLETE
    </td>
    <td>
     Y
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST
    </td>
    <td>
     Y
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REWRITE
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     Y
    </td>
    <td>
     SALES
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     N
    </td>
    <td>
     PRODUCTS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     N
    </td>
    <td>
     CUSTOMERS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     N
    </td>
    <td>
     COUNTRIES
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     N
    </td>
    <td>
     CHANNELS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     N
    </td>
    <td>
     TIMES
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.SALES
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.PRODUCTS
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.CUSTOMERS
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.COUNTRIES
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.CHANNELS
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.TIMES
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ONETAB_DML
    </td>
    <td>
     N
    </td>
    <td>
     TOTAL_AMOUNT_SOLD
    </td>
    <td align="right">
     2143
    </td>
    <td>
     SUM(expr) without COUNT(expr)
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ONETAB_DML
    </td>
    <td>
     N
    </td>
    <td>
     TOTAL_QUANTITY_SOLD
    </td>
    <td align="right">
     2143
    </td>
    <td>
     SUM(expr) without COUNT(expr)
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ONETAB_DML
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2146
    </td>
    <td>
     see the reason why REFRESH_FAST_AFTER_INSERT is disabled
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ONETAB_DML
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2142
    </td>
    <td>
     COUNT(*) is not present in the select list
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ONETAB_DML
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2143
    </td>
    <td>
     SUM(expr) without COUNT(expr)
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ANY_DML
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2161
    </td>
    <td>
     see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_PCT
    </td>
    <td>
     Y
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_FULL_TEXT_MATCH
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2159
    </td>
    <td>
     query rewrite is disabled on the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_PARTIAL_TEXT_MATCH
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2159
    </td>
    <td>
     query rewrite is disabled on the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_GENERAL
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2159
    </td>
    <td>
     query rewrite is disabled on the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_PCT
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2158
    </td>
    <td>
     general rewrite is not possible or PCT is not possible on any of the detail tables
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     SALES
    </td>
    <td align="right">
     2182
    </td>
    <td>
     PCT is enabled through a join dependency
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     PRODUCTS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     CUSTOMERS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     COUNTRIES
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     CHANNELS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     TIMES
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
  </tbody>
 </table>
 <p>
  And, the second materialized view created above,
  <span style="font-family:monospace">
   OCM11G_PROD
  </span>
  , is examined:
 </p>
 <blockquote style="font-family:monospace">
  EXEC DBMS_MVIEW.
  <a href="http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_mview.htm#CEGGEHHC" rel="nofollow">
   EXPLAIN_MVIEW
  </a>
  ( 'OCM11G_PROD', 'OCM11G2' )
  <br/>
  COMMIT;
  <br/>
  SELECT CAPABILITY_NAME,
  <br/>
  POSSIBLE,
  <br/>
  RELATED_TEXT,
  <br/>
  MSGNO,
  <br/>
  MSGTXT
  <br/>
  FROM mv_capabilities_table
  <br/>
  WHERE statement_id = 'OCM11G2';
  <br/>
 </blockquote>
 <p>
  The result is:
 </p>
 <table border="1" cellpadding="0" cellspacing="0">
  <thead>
   <tr>
    <th>
     CAPABILITY_NAME
    </th>
    <th>
     POSSIBLE
    </th>
    <th>
     RELATED_TEXT
    </th>
    <th>
     MSGNO
    </th>
    <th>
     MSGTXT
    </th>
   </tr>
  </thead>
  <tbody>
   <tr>
    <td>
     PCT
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_COMPLETE
    </td>
    <td>
     Y
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     REWRITE
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
    </td>
    <td>
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE
    </td>
    <td>
     N
    </td>
    <td>
     PRODUCTS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_INSERT
    </td>
    <td>
     N
    </td>
    <td>
     SH.PRODUCTS
    </td>
    <td align="right">
     2162
    </td>
    <td>
     the detail table does not have a materialized view log
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ONETAB_DML
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2146
    </td>
    <td>
     see the reason why REFRESH_FAST_AFTER_INSERT is disabled
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_AFTER_ANY_DML
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2161
    </td>
    <td>
     see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
    </td>
   </tr>
   <tr>
    <td>
     REFRESH_FAST_PCT
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2157
    </td>
    <td>
     PCT is not possible on any of the detail tables in the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_FULL_TEXT_MATCH
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2159
    </td>
    <td>
     query rewrite is disabled on the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_PARTIAL_TEXT_MATCH
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2159
    </td>
    <td>
     query rewrite is disabled on the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_GENERAL
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2159
    </td>
    <td>
     query rewrite is disabled on the materialized view
    </td>
   </tr>
   <tr>
    <td>
     REWRITE_PCT
    </td>
    <td>
     N
    </td>
    <td>
    </td>
    <td align="right">
     2158
    </td>
    <td>
     general rewrite is not possible or PCT is not possible on any of the detail tables
    </td>
   </tr>
   <tr>
    <td>
     PCT_TABLE_REWRITE
    </td>
    <td>
     N
    </td>
    <td>
     PRODUCTS
    </td>
    <td align="right">
     2068
    </td>
    <td>
     relation is not a partitioned table
    </td>
   </tr>
  </tbody>
 </table>
 <h4>
  <a name="TOC-Enable-Query-Rewrite">
  </a>
  Enable Query Rewrite
 </h4>
 <p>
  In both of the materialized views examined above, query rewrite is disabled .
 </p>
</div>
