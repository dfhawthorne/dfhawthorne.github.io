---
layout: default
title: '07 Adjusted MEMORY_TARGET for OCM11G Database'
base-url: home/11g-ocm/11g-ocm-system-builds/bankstown/07-adjusted-memory_target-for-ocm11g-database.html
breadcrumbs:
- title: 'Home'
  url: home.html
- title: '11G OCM'
  url: home/11g-ocm.html
- title: '11G OCM System Builds'
  url: home/11g-ocm/11g-ocm-system-builds.html
- title: 'BANKSTOWN'
  url: home/11g-ocm/11g-ocm-system-builds/bankstown.html
- title: '07 Adjusted MEMORY_TARGET for OCM11G Database'
  url: home/11g-ocm/11g-ocm-system-builds/bankstown/07-adjusted-memory_target-for-ocm11g-database.html
scroll-bar:
  left-link:
    url: home/11g-ocm/11g-ocm-system-builds/bankstown/07-adjusted-memory_target-for-ocm11g-database.html
    title: '06 EM Agent Does Not Start After Server is on New Subnet'
---
<div dir="ltr">
 <h3>
  <a name="TOC-References">
  </a>
  References
 </h3>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/toc.htm" rel="nofollow">
   Oracle® Database Administrator's Guide 11g Release 1 (11.1)
  </a>
 </p>
 <ul compact="compact">
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create.htm#insertedID0" rel="nofollow">
    Chapter 2, "Creating and Configuring an Oracle Database"
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create005.htm#insertedID0" rel="nofollow">
     Specifying Initialization Parameters
    </a>
   </li>
   <ul compact="compact">
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create005.htm#i1013946" rel="nofollow">
      About Initialization Parameters and Initialization Parameter Files
     </a>
    </li>
   </ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create006.htm#insertedID0" rel="nofollow">
     Managing Initialization Parameters Using a Server Parameter File
    </a>
   </li>
   <ul compact="compact">
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create006.htm#insertedID10" rel="nofollow">
      Recovering a Lost or Damaged Server Parameter File
     </a>
    </li>
   </ul>
  </ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/start.htm#insertedID0" rel="nofollow">
    Chapter 3, "Starting Up and Shutting Down"
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/start001.htm#insertedID0" rel="nofollow">
     Starting Up a Database
    </a>
   </li>
   <ul compact="compact">
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/start001.htm#insertedID4" rel="nofollow">
      Starting Up an Instance
     </a>
    </li>
   </ul>
  </ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag.htm#adminChapterDiagnosability" rel="nofollow">
    Chapter 8, "Managing Diagnostic Data"
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag001.htm#insertedID0" rel="nofollow">
     About the Oracle Database Fault Diagnosability Infrastructure
    </a>
   </li>
   <ul compact="compact">
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag001.htm#insertedID0" rel="nofollow">
      Diagnosability Infrastructure
     </a>
    </li>
    <ul compact="compact">
     <li>
      <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag001.htm#insertedID3" rel="nofollow">
       Fault Diagnosability Infrastructure Components
      </a>
     </li>
     <ul>
      <li>
       <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag001.htm#CHDBGJAI" rel="nofollow">
        ADRCI Command-Line Utility
       </a>
      </li>
     </ul>
    </ul>
   </ul>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28318/toc.htm" rel="nofollow">
   Oracle® Database Concepts 11g Release 1 (11.1)
  </a>
 </p>
 <ul compact="compact">
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28318/startup.htm#insertedID0" rel="nofollow">
    Chapter 12, "Database and Instance Startup and Shutdown"
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28318/startup.htm#CHDFGJIH" rel="nofollow">
     Introduction to an Oracle Instance
    </a>
   </li>
   <ul compact="compact">
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28318/startup.htm#i9633" rel="nofollow">
      Initialization Parameter Files and Server Parameter Files
     </a>
    </li>
   </ul>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/toc.htm" rel="nofollow">
   Oracle® Database Reference 11g Release 1 (11.1)
  </a>
 </p>
 <ul compact="compact">
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/initparams_part.htm#i200948" rel="nofollow">
    Part I Initialization Parameters
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/initparams133.htm#I1010285" rel="nofollow">
     <code>
      MEMORY_TARGET
     </code>
    </a>
   </li>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/toc.htm" rel="nofollow">
   Oracle® Database SQL Language Reference 11g Release 1 (11.1)
  </a>
 </p>
 <ul compact="compact">
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6016.htm#i2072626" rel="nofollow">
    <code>
     CREATE SPFILE
    </code>
   </a>
  </li>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/toc.htm" rel="nofollow">
   Oracle® Database Utilities 11g Release 1 (11.1)
  </a>
 </p>
 <ul compact="compact">
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#insertedID0" rel="nofollow">
    Chapter 15, "ADRCI: ADR Command Interpreter"
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBBBGEF" rel="nofollow">
     Starting ADRCI and Getting Help
    </a>
   </li>
   <ul compact="compact">
    <li>
     <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBBADAB" rel="nofollow">
      Using ADRCI in Interactive Mode
     </a>
    </li>
   </ul>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBCAABI" rel="nofollow">
     Setting the ADRCI Homepath Before Using ADRCI Commands
    </a>
   </li>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBBBBEA" rel="nofollow">
     Viewing the Alert Log
    </a>
   </li>
  </ul>
 </ul>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/toc.htm" rel="nofollow">
   SQL*Plus® User's Guide and Reference
Release 11.1
  </a>
 </p>
 <ul>
  <li>
   <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12.htm#CIHCHDFI" rel="nofollow">
    Chapter 12, "SQL*Plus Command Reference"
   </a>
  </li>
  <ul compact="compact">
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12042.htm#i2699551" rel="nofollow">
     <code>
      SHUTDOWN
     </code>
    </a>
   </li>
   <li>
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12045.htm#i2699631" rel="nofollow">
     <code>
      STARTUP
     </code>
    </a>
   </li>
  </ul>
 </ul>
 <h3>
  <a name="TOC-Overview">
  </a>
  Overview
 </h3>
 <p>
  I reduced the memory allocated to the
  <code>
   BANKSTOWN
  </code>
  VM image from 2GB to 1GB after removing ASM. I created a database called
  <code>
   ocm11g
  </code>
  before doing the reduction, and got an error on startup.
 </p>
 <p>
  I managed to fix this by using a temporary initialization parameter file (PFILE) instead of using the server parameter file (SPFILE) (see
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28318/startup.htm#i9633" rel="nofollow">
   Initialization Parameter Files and Server Parameter Files
  </a>
  ).
 </p>
 <p>
  This procedure is based on "
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create006.htm#insertedID10" rel="nofollow">
   Recovering a Lost or Damaged Server Parameter File
  </a>
  ":
 </p>
 <blockquote>
  <ol>
   <li>
    Create a text initialization parameter file (PFILE) from the parameter value listings in the alert log.
   </li>
   <p>
    When an instance starts up, the initialization parameters used for startup are written to the alert log. You can copy and paste this section from the text version of the alert log (without XML tags) into a new PFILE.
   </p>
   <p>
    See
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag005.htm#CHDGCEIH" rel="nofollow">
     "Viewing the Alert Log"
    </a>
    for more information.
   </p>
   <li>
    Create the SPFILE from the PFILE.
   </li>
   <p>
    See
    <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create006.htm#i1010013" rel="nofollow">
     "Creating a Server Parameter File"
    </a>
    for instructions.
   </p>
  </ol>
 </blockquote>
 <h3>
  <a name="TOC-Analysis">
  </a>
  Analysis
 </h3>
 <h4>
  <a name="TOC-Error-Message">
  </a>
  Error Message
 </h4>
 <p>
  Get the following message on startup for
  <code>
   ocm11g
  </code>
  database instance:
 </p>
 <blockquote style="font-family:monospace">
  2012-02-01 09:52:02.939000 +11:00
  <br/>
  WARNING: You are trying to use the MEMORY_TARGET feature. This feature requires the /dev/shm file system to be mounted for at least 851443712 bytes. /dev/shm is either not mounted or is mounted with available space less than this size. Please fix this so that MEMORY_TARGET can work as expected. Current available is 529989632 and used is 0 bytes.
  <br/>
  memory_target needs larger /dev/shm
 </blockquote>
 <p>
  The instance cannot start even in
  <code>
   NOMOUNT
  </code>
  mode.
 </p>
 <h4>
  <a name="TOC-Reconstract-the-Database-Server-Parameter-File">
  </a>
  Reconstract the Database Server Parameter File
 </h4>
 <p>
  I used the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/diag001.htm#CHDBGJAI" rel="nofollow">
   ADRCI Command-Line Utility
  </a>
  to extract the startup parameters from the database server alert log.
 </p>
 <h5>
  <a name="TOC-Starting-ADRCI">
  </a>
  Starting ADRCI
 </h5>
 <p>
  From
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBBADAB" rel="nofollow">
   Using ADRCI in Interactive Mode
  </a>
  , I issued the following commands:
 </p>
 <pre>export ORACLE_BASE=/u00/app/oracle
export ORACLE_HOME=$ORACLE_BASE/product/11.1.0/db_1
export PATH=$ORACLE_HOME/bin:$PATH
adrci
</pre>
 <p>
  The first three (3) lines were unnecessary because I had already incorporated them into the
  <code>
   .bashrc
  </code>
  file for the
  <code>
   oracle
  </code>
  user.
 </p>
 <h5>
  <a name="TOC-Set-the-ADRCI-Home-Path">
  </a>
  Set the ADRCI Home Path
 </h5>
 <p>
  Using the procedure in
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBCAABI" rel="nofollow">
   Setting the ADRCI Homepath Before Using ADRCI Commands
  </a>
  , I ran the following commands:
 </p>
 <blockquote style="font-family:monospace">
  [oracle@bankstown ~]$ adrci
  <br/>
  <br/>
  ADRCI: Release 11.1.0.7.0 - Production on Thu Feb 9 23:01:57 2012
  <br/>
  <br/>
  Copyright (c) 1982, 2007, Oracle.  All rights reserved.
  <br/>
  <br/>
  ADR base = "/u00/app/oracle"
  <br/>
  adrci&gt; show homes
  <br/>
  ADR Homes:
  <br/>
  diag/tnslsnr/bankstown/listener
  <br/>
  <span style="color:green;font-weight:bold">
   diag/rdbms/ocm11g/ocm11g
  </span>
  <br/>
  diag/rdbms/unknown/ocm11g
  <br/>
  diag/clients/user_oracle/host_183182459_11
  <br/>
  adrci&gt; set home diag/rdbms/ocm11g/ocm11g
 </blockquote>
 <h5>
  <a name="TOC-Find-the-Startup-Parameters">
  </a>
  Find the Startup Parameters
 </h5>
 <p>
  I used the procedure in
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28319/adrci.htm#BGBBBBEA" rel="nofollow">
   Viewing the Alert Log
  </a>
  to search for the startup parameters:
 </p>
 <pre>adrci&gt; show alert
</pre>
 <blockquote style="font-family:monospace">
  Starting up ORACLE RDBMS Version: 11.1.0.7.0.
  <br/>
  Using parameter settings in server-side spfile
  <span style="font-weight:bold;color:green">
   /u00/app/oracle/product/11.1.0/db_1/dbs/spfileocm11g.ora
  </span>
  <br/>
  System parameters with non-default values:
  <br/>
  processes                = 150
  <br/>
  nls_language             = "ENGLISH"
  <br/>
  nls_territory            = "AUSTRALIA"
  <br/>
  <span style="font-weight:bold;color:red">
   memory_target            = 812M
  </span>
  <br/>
  control_files            = "/u01/app/oracle/oradata/ocm11g/OCM11G/controlfile/o1_mf_7lhgdzry_.ctl"
  <br/>
  control_files            = "/u02/app/oracle/oradata/ocm11g/OCM11G/controlfile/o1_mf_7lhgf4q7_.ctl"
  <br/>
  db_block_size            = 8192
  <br/>
  compatible               = "11.1.0.0.0"
  <br/>
  log_archive_format       = "%t_%s_%r.dbf"
  <br/>
  db_create_file_dest      = "/u01/app/oracle/oradata/ocm11g"
  <br/>
  db_create_online_log_dest_1= "/u01/app/oracle/oradata/ocm11g"
  <br/>
  db_create_online_log_dest_2= "/u02/app/oracle/oradata/ocm11g"
  <br/>
  db_recovery_file_dest    = "/u02/app/oracle/oradata/ocm11g/flash_recovery_area"
  <br/>
  db_recovery_file_dest_size= 4G
  <br/>
  undo_tablespace          = "UNDOTBS1"
  <br/>
  remote_login_passwordfile= "EXCLUSIVE"
  <br/>
  db_domain                = "yaocm.id.au"
  <br/>
  dispatchers              = "(PROTOCOL=TCP) (SERVICE=ocm11gXDB)"
  <br/>
  audit_file_dest          = "/u00/app/oracle/admin/ocm11g/adump"
  <br/>
  audit_trail              = "DB"
  <br/>
  db_name                  = "ocm11g"
  <br/>
  open_cursors             = 300
  <br/>
  star_transformation_enabled= "TRUE"
  <br/>
  diagnostic_dest          = "/u00/app/oracle"
 </blockquote>
 <p>
  The line highlighted in
  <span style="font-weight:bold;color:red">
   red
  </span>
  needs to be changed.
 </p>
 <p>
  The name of the server parameter file is highlighted in
  <span style="font-weight:bold;color:green">
   green
  </span>
  .
 </p>
 <h5>
  <a name="TOC-Create-PFILE">
  </a>
  Create PFILE
 </h5>
 <p>
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/create005.htm#i1013946" rel="nofollow">
   About Initialization Parameters and Initialization Parameter Files
  </a>
  says that
  <cite>
   Text Initialization Parameter File Format
  </cite>
  allows:
 </p>
 <blockquote>
  <p>
   For parameters that accept multiple values,
   <span style="font-weight:bold">
    to enable you to easily copy and paste name/value pairs from the alert log
   </span>
   , you can repeat a parameter on multiple lines, where each line contains a different value.
  </p>
  <p style="text-align:right;font-weight:bold">
   Emphasis Mine
  </p>
 </blockquote>
 <p>
  The non-default parameters are copied from the alert log into
  <code>
   /tmp/initocm11g.ora
  </code>
  , and the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28320/initparams133.htm#I1010285" rel="nofollow">
   <code>
    MEMORY_TARGET
   </code>
  </a>
  parameter is changed to the following:
 </p>
 <pre>  memory_target            = 452M
</pre>
 <h4>
  <a name="TOC-Start-the-Instance-in-NOMOUNT-Mode">
  </a>
  Start the Instance in NOMOUNT Mode
 </h4>
 <p>
  "
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/start001.htm#insertedID4" rel="nofollow">
   Starting Up an Instance
  </a>
  " says that:
 </p>
 <blockquote>
  <p>
   You can start an instance without mounting a database. Typically, you do so only during database creation. Use the STARTUP command with the NOMOUNT clause:
  </p>
  <pre>STARTUP NOMOUNT 
</pre>
 </blockquote>
 <p>
  I only need the
  <code>
   NOMOUNT
  </code>
  to create the SPFILE.
 </p>
 <p>
  In order to read the text initialization parameter file (PFILE), I use the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12045.htm#i2699631" rel="nofollow">
   <code>
    STARTUP
   </code>
  </a>
  command as follows to start the instance in NOMOUNT mode:
 </p>
 <pre>sqlplus /NOLOG
STARTUP NOMOUNT PFILE=/tmp/initocm11g.ora
</pre>
 <h4>
  <a name="TOC-Create-SPFILE-from-PFILE">
  </a>
  Create SPFILE from PFILE
 </h4>
 <p>
  Once the database instance has been started in NOMOUNT mode, I can use the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6016.htm#i2072626" rel="nofollow">
   <code>
    CREATE SPFILE
   </code>
  </a>
  as follows to create a valid version:
 </p>
 <blockquote style="font-family:monospace">
  CREATE SPFILE='/u00/app/oracle/product/11.1.0/db_1/dbs/spfileocm11g.ora' FROM PFILE='/tmp/initocm11g.ora';
 </blockquote>
 <p>
  The name of the
  <code>
   SPFILE
  </code>
  was gotten from the alert log above, and the name of the
  <code>
   PFILE
  </code>
  was gotten from the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12045.htm#i2699631" rel="nofollow">
   <code>
    STARTUP
   </code>
  </a>
  command used to start the instance.
 </p>
 <h4>
  <a name="TOC-Start-the-Instance-Using-the-SPFILE">
  </a>
  Start the Instance Using the SPFILE
 </h4>
 <p>
  Now that I have recreated the
  <code>
   SPFILE
  </code>
  with valid parameters, I can use the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12042.htm#i2699551" rel="nofollow">
   <code>
    SHUTDOWN
   </code>
  </a>
  command followed by the
  <a href="http://docs.oracle.com/cd/B28359_01/server.111/b31189/ch12045.htm#i2699631" rel="nofollow">
   <code>
    STARTUP
   </code>
  </a>
  command to start the instance as follows:
 </p>
 <pre>SHUTDOWN IMMEDIATE
STARTUP
</pre>
 <p>
  This will ensure that the default SPFILE is correct.
 </p>
</div>
